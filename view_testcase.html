<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <!-- <h4>viewing page of <?php echo $_GET["id"];?></h4> -->
    <label for="cars">Choose an Action</label>
    <select name="cars" id="action_set">
    </select>
    <button onclick="return add_action()">Add</button>
    <div id="action_container">
        <table style="border-style: groove;  margin: 10px 20px 20px 10px;">
            <thead><th><button test="del_action">delete</button></th></thead>
            <tbody>
                <tr>
                    <td width="5%"><button test="add_row">add</button></td>
                    <td width="25%"><input value="att_name" type="text" name="" id=""></td>
                    <td width="20%"><input value="element parameter" type="text" name="" id=""></td>
                    <td width="45%"><textarea name="" id="">att_val</textarea></td>
                    <td width="5%"><button test="del_row">del</button></td>
                </tr>
                <tr>
                    <td width="5%"><button test="add_row">add</button></td>
                    <td width="25%"><input value="click" type="text" name="" id=""></td>
                    <td width="20%"><input value="selenium action" type="text" name="" id=""></td>
                    <td width="45%"><textarea name="" id="">click</textarea></td>
                    <td width="5%"><button test="del_row">del</button></td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
    document.getElementById("action_container").addEventListener("click", del_action);
    
    action_db = {
        go_to_link:[
            ["go to link", "selenium action", "https://demo.zeuz.ai/web/level/one/scenerios/login"],
        ],
        click:[
            ["att_name", "selenium action", "att_val"],
            ["click", "selenium action", "click"],
        ],
        enter_text:[
            ["att_name", "selenium action", "att_val"],
            ["text", "selenium action", "val"],
        ],
        
    }
    const new_row = `<tr><td width="5%"><button test="add_row">add</button></td>
        <td width="25%"><input value="" type="text" name="" id=""></td>
        <td width="20%"><input value="" type="text" name="" id=""></td>
        <td width="45%"><textarea name="" id=""></textarea></td>
        <td width="5%"><button test="del_row">del</button></td></tr>
        `
    let select = document.getElementById("action_set");
    action_datasets = {}
    for (var key of Object.keys(action_db)) {
        var option = document.createElement('option');
        _key = key.replaceAll("_", " ");
        _key = _key.charAt(0).toUpperCase() + _key.toLocaleLowerCase().substring(1)
        option.innerText = _key;
        option.setAttribute("value", key);
        select.appendChild(option);

        action = action_db[key];
        action_text = `<table style="border-style: groove;  margin: 10px 20px 20px 10px;}">
            <thead><th><button test="del_action">delete</button></th></thead>
            <tbody>`;
        for(i=0;i<action.length;i++){
            action_text += '<tr><td width="5%"><button test="add_row">add</button></td>';
            action_text += `<td width="25%"><input value="${action[i][0]}" type="text" name="" id=""></td>`
            action_text += `<td width="20%"><input value="${action[i][1]}" type="text" name="" id=""></td>`
            action_text += `<td width="45%"><textarea name="" id="">${action[i][2]}</textarea></td>`
            action_text += '<td width="5%"><button test="del_row">del</button></td></tr>';
        }
        action_text += `</tbody></table>`;
        action_datasets[key] = action_text
    }
    
    function add_action() {
        table_text = action_datasets[document.getElementById("action_set").value];
        let ac_container = document.getElementById("action_container");
        var div = document.createElement('div');
        div.innerHTML = table_text.trim();
        let del_button = div.getElementsByTagName("button")[0];
        ac_container.appendChild(div.firstChild);
    }

    function del_action(e) {
        if(e.target.tagName == "BUTTON" && e.target.getAttribute("test") == "del_action"){
            element=e.target.parentElement.parentElement.parentElement.parentElement;
            element.parentElement.removeChild(element);
        }
        else if(e.target.tagName == "BUTTON" && e.target.getAttribute("test") == "del_row"){
            tr=e.target.parentElement.parentElement;
            tbody = tr.parentElement;
            table = tbody.parentElement;
            tr.parentElement.removeChild(tr);

            if(tbody.childElementCount ==0){
                table.parentElement.removeChild(table);
            }
        }
        else if(e.target.tagName == "BUTTON" && e.target.getAttribute("test") == "add_row"){
            let table = document.createElement('table');
            table.innerHTML = new_row.trim();
            new_elem = table.firstChild.firstChild;
            tr = e.target.parentElement.parentElement;
            tbody = tr.parentElement;
            tbody.insertBefore(new_elem,tr);
        }
        
    }
    </script>
</body>

</html>